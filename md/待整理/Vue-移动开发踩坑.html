<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue-移动开发踩坑 | My vuepress</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/favicon.ico">
    <script src="https://hm.baidu.com/hm.js?xxxxxxxxxxx"></script>
    <meta name="description" content="Todo">
    <meta name="robots" content="all">
    <meta name="author" content="pdai">
    <meta name="keywords" content="Java 全栈知识体系, java体系, java知识体系, java框架,java详解,java学习路线,java spring, java面试, 知识体系, java技术体系, java编程, java编程指南,java开发体系, java开发,java教程,java,java数据结构, 算法, 开发基础">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="preload" href="/assets/css/0.styles.144ea653.css" as="style"><link rel="preload" href="/assets/js/app.afcd353c.js" as="script"><link rel="preload" href="/assets/js/2.6527dd7c.js" as="script"><link rel="preload" href="/assets/js/67.aeba61a8.js" as="script"><link rel="prefetch" href="/assets/js/10.b8af9589.js"><link rel="prefetch" href="/assets/js/11.da070787.js"><link rel="prefetch" href="/assets/js/12.e8c2df3f.js"><link rel="prefetch" href="/assets/js/13.13f8690b.js"><link rel="prefetch" href="/assets/js/14.97d7a7c6.js"><link rel="prefetch" href="/assets/js/15.ca82dd18.js"><link rel="prefetch" href="/assets/js/16.0795663b.js"><link rel="prefetch" href="/assets/js/17.9f529ede.js"><link rel="prefetch" href="/assets/js/18.aa494d1d.js"><link rel="prefetch" href="/assets/js/19.c5e368a6.js"><link rel="prefetch" href="/assets/js/20.8486962d.js"><link rel="prefetch" href="/assets/js/21.1a96e733.js"><link rel="prefetch" href="/assets/js/22.5b4929c3.js"><link rel="prefetch" href="/assets/js/23.7bc228ce.js"><link rel="prefetch" href="/assets/js/24.63116242.js"><link rel="prefetch" href="/assets/js/25.e9163e8b.js"><link rel="prefetch" href="/assets/js/26.31132baf.js"><link rel="prefetch" href="/assets/js/27.728265df.js"><link rel="prefetch" href="/assets/js/28.4cb93316.js"><link rel="prefetch" href="/assets/js/29.30a99cb0.js"><link rel="prefetch" href="/assets/js/3.e3c760c5.js"><link rel="prefetch" href="/assets/js/30.39c64819.js"><link rel="prefetch" href="/assets/js/31.78e9d272.js"><link rel="prefetch" href="/assets/js/32.e71f2609.js"><link rel="prefetch" href="/assets/js/33.b182a570.js"><link rel="prefetch" href="/assets/js/34.d919b2af.js"><link rel="prefetch" href="/assets/js/35.e2cdb183.js"><link rel="prefetch" href="/assets/js/36.759e107d.js"><link rel="prefetch" href="/assets/js/37.a0ccb526.js"><link rel="prefetch" href="/assets/js/38.8f8ec90d.js"><link rel="prefetch" href="/assets/js/39.bcb56569.js"><link rel="prefetch" href="/assets/js/4.e1e5a770.js"><link rel="prefetch" href="/assets/js/40.cb9e68d1.js"><link rel="prefetch" href="/assets/js/41.f7324d34.js"><link rel="prefetch" href="/assets/js/42.fbc4875e.js"><link rel="prefetch" href="/assets/js/43.602efb90.js"><link rel="prefetch" href="/assets/js/44.5cdea7dd.js"><link rel="prefetch" href="/assets/js/45.08b55f16.js"><link rel="prefetch" href="/assets/js/46.89b660d7.js"><link rel="prefetch" href="/assets/js/47.8041c4a7.js"><link rel="prefetch" href="/assets/js/48.54a6e067.js"><link rel="prefetch" href="/assets/js/49.63fc5fb5.js"><link rel="prefetch" href="/assets/js/5.b9a4a83e.js"><link rel="prefetch" href="/assets/js/50.defc28ad.js"><link rel="prefetch" href="/assets/js/51.01fa48a2.js"><link rel="prefetch" href="/assets/js/52.04cb5e30.js"><link rel="prefetch" href="/assets/js/53.b04e4c27.js"><link rel="prefetch" href="/assets/js/54.a99c8dca.js"><link rel="prefetch" href="/assets/js/55.f15500bf.js"><link rel="prefetch" href="/assets/js/56.c9d0f497.js"><link rel="prefetch" href="/assets/js/57.eb7e4183.js"><link rel="prefetch" href="/assets/js/58.4a5207ff.js"><link rel="prefetch" href="/assets/js/59.8620aeb6.js"><link rel="prefetch" href="/assets/js/6.ddfdb723.js"><link rel="prefetch" href="/assets/js/60.a1b1dae5.js"><link rel="prefetch" href="/assets/js/61.e6ec84e2.js"><link rel="prefetch" href="/assets/js/62.8703dde9.js"><link rel="prefetch" href="/assets/js/63.76d6c8fe.js"><link rel="prefetch" href="/assets/js/64.1abf1796.js"><link rel="prefetch" href="/assets/js/65.7430076b.js"><link rel="prefetch" href="/assets/js/66.9ca1a22b.js"><link rel="prefetch" href="/assets/js/68.81e8ae85.js"><link rel="prefetch" href="/assets/js/69.fb8f7d5d.js"><link rel="prefetch" href="/assets/js/7.6689766d.js"><link rel="prefetch" href="/assets/js/70.f55dc26a.js"><link rel="prefetch" href="/assets/js/71.d310670d.js"><link rel="prefetch" href="/assets/js/72.d0b65202.js"><link rel="prefetch" href="/assets/js/73.fbee5211.js"><link rel="prefetch" href="/assets/js/74.952412ed.js"><link rel="prefetch" href="/assets/js/75.2f6086aa.js"><link rel="prefetch" href="/assets/js/76.7b2a8f50.js"><link rel="prefetch" href="/assets/js/77.f75ad0d8.js"><link rel="prefetch" href="/assets/js/8.1f4717e3.js"><link rel="prefetch" href="/assets/js/9.a70f9ef6.js">
    <link rel="stylesheet" href="/assets/css/0.styles.144ea653.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">My vuepress</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/md/java/base/Base.html" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/md/about/并发编程.html" class="nav-link">
  关于
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/md/java/base/Base.html" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/md/about/并发编程.html" class="nav-link">
  关于
</a></div> <!----></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="css像素"><a href="#css像素" class="header-anchor">#</a> css像素</h1> <p>按照以前的理解css中1px就是屏幕上的一个点，是屏幕能显示的最小单位，实际情况并没有那么简单。</p> <p>首先有三个概念：
CSS像素（CSS Pixel）：适用于web编程，指的是我们在样式代码中使用到的逻辑像素，是一个抽象概念，实际并不存在
设备独立像素（Device Independent Pixel）：与设备无关的逻辑像素，代表可以通过程序控制使用的虚拟像素，是一个总体概念，包括了CSS像素
设备像素（Device Pixel）：物理像素，设备能控制显示的最小单位，我们常说的1920×1080像素分辨率就是用的设备像素单位</p> <h2 id="设备像素"><a href="#设备像素" class="header-anchor">#</a> 设备像素</h2> <p>设备像素也被称作为物理像素，它表示显示设备的真实像素，此像素是设备的固有属性，也就是说，从出厂的那一刻，设备像素已经固定，不会再发生改变。
设备像素也就是我们平常说的屏幕分辨率（物理分辨率），它是屏幕能显示的最小单位，例如1920*1080，表示设备横向有1920像素点，纵向有1080个像素点。</p> <p><code>设备像素 = 物理像素 = 屏幕分辨率 = 屏幕物理分辨率</code>
上面都是的概念都是一个意思，一开始还是很容易搞不清楚的。</p> <h2 id="设备独立像素"><a href="#设备独立像素" class="header-anchor">#</a> 设备独立像素</h2> <p><code>设备独立像素 = 逻辑像素 = 屏幕逻辑分辨率</code> 是一个意思。</p> <p>PC端 —— 1个设备独立像素 = 1个设备像素 （在100%，未缩放的情况下，如果缩放到200%可以说1个设备独立像素 = 2个设备像素）</p> <p>移动端 —— 根据设备不同有很大的差异，根据 ppi 不同我们可以得到不同的换算关系，标准屏幕（160ppi）下 1个设备独立像素 = 1个设备像素</p> <p>从这里可以看出在pc端，css的1px就是屏幕上1像素（物理像素 = 逻辑像素）</p> <p>在移动端就不一定了，iphone6 750 x 1344分辨率，对某一元素设置css：width = 750px，元素的宽度是屏幕的2倍
原因就是iphone6的逻辑分辨率是 375 x 667。</p> <h1 id="移动端设计中的一些参数"><a href="#移动端设计中的一些参数" class="header-anchor">#</a> 移动端设计中的一些参数</h1> <p><img src="/images/ref/%E7%A7%BB%E5%8A%A8%E5%BC%80%E5%8F%917.png" alt="Alt text"></p> <p>以iphone6来说
屏幕尺寸： 4.7英寸
逻辑分辨率：375×667pt
物理分辨率: 750×1334px
像素密度: 326ppi
缩放因子：@2x</p> <h2 id="pt"><a href="#pt" class="header-anchor">#</a> pt</h2> <p>ios中pt是逻辑像素的单位，pt表示屏幕上的一个点，在非retina屏幕上 1pt=1px, 在retina屏幕上相同的长度可以显示以前两倍的像素 1pt = 2px,在iphone6 plus上 1pt = 3px。</p> <p>pt是一个绝对长度，和米、厘米一样只是要小的多，苹果之所用固定长度pt作为开发单位的好处是：这样可以统一图形在同一种类不同型号设备上图形的大小。而如果用像素作为单位的话，就乱了套了，因为在不同像素密度的屏幕里面，像素本身大小是不一样的。</p> <h2 id="屏幕尺寸"><a href="#屏幕尺寸" class="header-anchor">#</a> 屏幕尺寸</h2> <p>4.7英寸指的是屏幕对角线的距离为4.7英寸。
同时屏幕每行有750个像素，每列有1334个像素。
<img src="/images/ref/%E7%A7%BB%E5%8A%A8%E5%BC%80%E5%8F%915.png" alt="Alt text"></p> <h2 id="ppi"><a href="#ppi" class="header-anchor">#</a> ppi</h2> <p>ppi说的是像素密度,表示沿着屏幕对角线每英寸所拥有的像素数目，ppi的数值越高，代表显示屏能够以越高的密度显示图像。
<img src="/images/ref/%E7%A7%BB%E5%8A%A8%E5%BC%80%E5%8F%916.png" alt="Alt text"></p> <p>根据以上可以得出结论：ppi越大显示效果越好，单纯的说分辨率大小是没有意义的，要和屏幕大小一起考虑。</p> <blockquote><p>所以光看屏幕的分辨率对于设计师来说是不具备多少实际意义的，通过分辨率计算得出的像素密度（PPI）才是设计师要关心的问题，我们通过屏幕分辨率和屏幕尺寸就能计算出屏幕的像素密度的。</p></blockquote> <h2 id="缩放因子scale"><a href="#缩放因子scale" class="header-anchor">#</a> 缩放因子scale</h2> <p>dpr（device pixel ratio）：设备像素比 = 设备像素/设备独立像素，代表设备独立像素到设备像素的转换关系，在JS中可以通过 window.devicePixelRatio 获取</p> <p>iphone6 devicePixelRatio = 750 / 375 = 2</p> <p>这个2有什么含义呢，css中设置的2像素，标准屏上占据2个像素，在retina屏幕上实际上占据4个像素
<img src="/images/ref/%E7%A7%BB%E5%8A%A8%E5%BC%80%E5%8F%918.png" alt="Alt text"></p> <p>devicePixelRatio的值就是缩放因子，1就是@1x，2就是@2x，3就是@3x</p> <h3 id="对设计造成的影响"><a href="#对设计造成的影响" class="header-anchor">#</a> 对设计造成的影响</h3> <p>iPhone3GS时代,我们为一个应用提供图标,只需要icon.png。针对现在的iPhone4~6 Retina显示屏,需要制作额外的@2x高分辨率版本。</p> <p>iPhone3GS中,scale=1,如果要一个50x50大小的图，设计师就给你切一个50x50的icon.png
在iPhone4~6中,scale=2,则需要一个100×100的图，并且命名为icon@2x.png。
iPhone6+,scale=3，则需要提供一个150x150的图，并且命名为icon@3x.png。</p> <p>这样的目的是为了让图片在屏幕上同比例显示。</p> <h1 id="viewport"><a href="#viewport" class="header-anchor">#</a> viewport</h1> <blockquote><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
该meta标签的作用是让当前viewport的宽度等于设备的宽度，同时不允许用户手动缩放,也许允不允许用户缩放（进行响应式设计的前提）
</blockquote> <p><code>移动开发需要在index.html中加上上述标签，具体的效果就是为了让我们可以开发出适应不同设备的h5页面。</code></p> <hr> <p>移动设备上进行网页的重构或开发，首先得搞明白的就是移动设备上的viewport了。
只有明白了viewport的概念以及弄清楚了跟viewport有关的meta标签的使用，才能更好地让我们的网页适配或响应各种不同分辨率的移动设备。</p> <p>定义:
viewport 是用户网页的可视区域。
viewport 翻译为中文可以叫做&quot;视区&quot;。
手机浏览器是把页面放在一个虚拟的&quot;窗口&quot;（viewport）中，通常这个虚拟的&quot;窗口&quot;（viewport）比屏幕宽(移动设备上的浏览器都会把自己默认的viewport设为980px或1024px)，这样就不用把每个网页挤到很小的窗口中（这样会破坏没有针对手机浏览器优化的网页的布局），用户可以通过平移和缩放来看网页的不同部分。</p> <p>没有添加 viewport：
<img src="/images/ref/%E7%A7%BB%E5%8A%A8%E5%BC%80%E5%8F%911.png" alt="Alt text"></p> <p>添加 viewport：
<img src="/images/ref/%E7%A7%BB%E5%8A%A8%E5%BC%80%E5%8F%912.png" alt="Alt text"></p> <h2 id="content属性值"><a href="#content属性值" class="header-anchor">#</a> content属性值</h2> <p>width: 可视区域的宽度，值可为数字或关键词device-width
<code>device-width为设备的宽度（单位为缩放为 100% 时的 CSS 的像素）</code>
height: 同width
intial-scale:  页面首次被显示时可视区域的缩放级别，取值1.0则页面按实际尺寸显示，无任何缩放
maximum-scale：可视区域允许用户放大到的最大比例（1.0将禁止用户放大到实际尺寸之上）
minimum-scale：可视区域允许用户缩放到的最小比例
user-scalable: 是否可对页面进行缩放，no 禁止缩放</p> <h2 id="_1px"><a href="#_1px" class="header-anchor">#</a> 1px</h2> <blockquote><p>在移动端设置border为1px,边框会显示的很粗。由于在css中1px就是最小的单位了(1像素),小于1px的设置都不会生效
在移动端需要运用特别的css技巧来实现1px border</p></blockquote> <p>在桌面浏览器中css的1个像素往往都是对应着电脑屏幕的1个物理像素，但是在移动端中1px并不是移动设备屏幕的1个物理像素。
css中的像素只是一个抽象的单位，在不同的设备或不同的环境中,css中的1px所代表的设备物理像素是不同的。</p> <blockquote><p>在早先的移动设备中，屏幕像素密度都比较低，如iphone3，它的分辨率为320x480，在iphone3上，一个css像素确实是等于一个屏幕物理像素的。
后来随着技术的发展，移动设备的屏幕像素密度越来越高，从iphone4开始，苹果公司便推出了所谓的Retina屏，分辨率提高了一倍，变成640x960，但屏幕尺寸却没变化，这就意味着同样大小的屏幕上，像素却多了一倍，这时，一个css像素是等于两个物理像素的。
安卓设备根据屏幕像素密度可分为ldpi、mdpi、hdpi、xhdpi等不同的等级，分辨率也是五花八门，安卓设备上的一个css像素相当于多少个屏幕物理像素，也因设备的不同而不同，没有一个定论。</p></blockquote> <h2 id="devicepixelratio"><a href="#devicepixelratio" class="header-anchor">#</a> devicePixelRatio</h2> <p>在移动端浏览器中以及某些桌面浏览器中，window对象有一个devicePixelRatio属性，它的官方的定义为：设备物理像素和设备独立像素的比例，也就是 devicePixelRatio = 物理像素 / 独立像素。<code>css中的px就可以看做是设备的独立像素</code>，所以通过devicePixelRatio，我们可以知道该设备上一个css像素代表多少个物理像素。</p> <p>例如，在Retina屏的iphone上，devicePixelRatio的值为2，也就是说1个css像素相当于2个物理像素。</p> <h2 id="layout-viewport，visual-viewport，ideal-viewport"><a href="#layout-viewport，visual-viewport，ideal-viewport" class="header-anchor">#</a> layout viewport，visual viewport，ideal viewport</h2> <p>移动浏览器默认的viewport叫做 layout viewport，它比屏幕要宽(980px或1024px)，宽度可以通过document.documentElement.clientWidth 来获取。</p> <p>浏览器可视区域的大小叫做 visual viewport，它的宽度可以通过window.innerWidth来获取。</p> <p>现在已经有两个viewport了：layout viewport 和 visual viewport。但浏览器觉得还不够，因为现在越来越多的网站都会为移动设备进行单独的设计，所以必须还要有一个能完美适配移动设备的viewport。所谓的完美适配指的是，首先不需要用户缩放和横向滚动条就能正常的查看网站的所有内容；第二，显示的文字的大小是合适，比如一段14px大小的文字，不会因为在一个高密度像素的屏幕里显示得太小而无法看清，理想的情况是这段14px的文字无论是在何种密度屏幕，何种分辨率下，显示出来的大小都是差不多的。当然，不只是文字，其他元素像图片什么的也是这个道理。ppk把这个viewport叫做 ideal viewport，也就是第三个viewport——移动设备的理想viewport。</p> <p>ideal viewport并没有一个固定的尺寸，不同的设备拥有有不同的ideal viewport。所有的iphone的ideal viewport宽度都是320px，无论它的屏幕宽度是320还是640，也就是说，在iphone中，<code>css中的320px就代表iphone屏幕的宽度</code>。但是安卓设备就比较复杂了，有320px的，有360px的，有384px的等等。</p> <blockquote><p>viewport分为layout viewport  、 visual viewport   和 ideal viewport  三类，其中的ideal viewport是最适合移动设备的viewport，<code>ideal viewport的宽度等于移动设备的屏幕宽度</code>，只要在css中把某一元素的宽度设为ideal viewport的宽度(单位用px)，那么这个元素的宽度就是设备屏幕的宽度了，也就是宽度为100%的效果。
ideal viewport 的意义在于，无论在何种分辨率的屏幕下，那些针对ideal viewport 而设计的网站，不需要用户手动缩放，也不需要出现横向滚动条，都可以完美的呈现给用户。</p></blockquote> <h2 id="initial-scale缩放"><a href="#initial-scale缩放" class="header-anchor">#</a> initial-scale缩放</h2> <p>initial-scale：页面首次被显示时可视区域(visual  viewport)的缩放级别，取值1.0则页面按实际尺寸显示，无任何缩放。</p> <p>首先缩放是相对于ideal viewport来缩放的，缩放值越大，当前viewport的宽度就会越小。
在iphone中，ideal viewport的宽度是320px，如果我们设置 initial-scale=2 ，此时viewport的宽度会变为只有160px了。
由此带来的效果是，在实际宽度不变的情况下原来1px变成2px了，但是1px变为2px并不是把原来的320px变为640px了，而是在实际宽度不变的情况下，1px变得跟原来的2px的长度一样了，所以放大2倍后原来需要320px才能填满的宽度现在只需要160px就可以了。</p> <p>我们可以得出一个公式：<code>visual viewport宽度 = ideal viewport宽度 / 当前缩放值</code></p> <p>好了，现在再来说下initial-scale的默认值问题，就是不写这个属性的时候，它的默认值会是多少呢？很显然不会是1，因为当 initial-scale = 1 时，当前的layout viewport宽度会被设为 ideal viewport的宽度，但前面说了，各浏览器默认的 layout viewport宽度一般都是980啊，1024啊，800啊等等这些个值，没有一开始就是 ideal viewport的宽度的，所以 initial-scale的默认值肯定不是1。安卓设备上的initial-scale默认值好像没有方法能够得到，或者就是干脆它就没有默认值，一定要你显示的写出来这个东西才会起作用，我们不管它了，这里我们重点说一下iphone和ipad上的initial-scale默认值。</p> <p>根据测试，我们可以在iphone和ipad上得到一个结论，就是无论你给layout viewpor设置的宽度是多少，而又没有指定初始的缩放值的话，那么iphone和ipad会自动计算initial-scale这个值，以保证当前layout viewport的宽度在缩放后就是浏览器可视区域的宽度，也就是说不会出现横向滚动条。比如说，在iphone上，我们不设置任何的viewport meta标签，此时layout viewport的宽度为980px，但我们可以看到浏览器并没有出现横向滚动条，浏览器默认的把页面缩小了。根据上面的公式，当前缩放值 = ideal viewport宽度  / visual viewport宽度，我们可以得出：</p> <p>当前缩放值 = 320 / 980</p> <p>也就是当前的initial-scale默认值应该是 0.33这样子。当你指定了initial-scale的值后，这个默认值就不起作用了。</p> <p>总之记住这个结论就行了：在iphone和ipad上，无论你给viewport设的宽的是多少，如果没有指定默认的缩放值，则iphone和ipad会自动计算这个缩放值，以达到当前页面不会出现横向滚动条(或者说viewport的宽度就是屏幕的宽度)的目的。
<img src="/images/ref/%E7%A7%BB%E5%8A%A8%E5%BC%80%E5%8F%913.png" alt="Alt text"></p> <h2 id="动态改变viewport"><a href="#动态改变viewport" class="header-anchor">#</a> 动态改变viewport</h2> <p>1.可以使用document.write来动态输出meta viewport标签</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,initial-scale=1&quot;&gt;'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>2.通过setAttribute来改变</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>meta id<span class="token operator">=</span><span class="token string">&quot;testViewport&quot;</span> name<span class="token operator">=</span><span class="token string">&quot;viewport&quot;</span> content<span class="token operator">=</span><span class="token string">&quot;width = 380&quot;</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">var</span> mvp <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'testViewport'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mvp<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'content'</span><span class="token punctuation">,</span><span class="token string">'width=480'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>为了实现对不同设备的自适应布局，后面会用到。</p> <h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p>首先如果不设置meta viewport标签，那么移动设备上浏览器默认的宽度值为800px，980px，1024px等这些，总之是大于屏幕宽度的。这里的宽度所用的单位px都是指css中的px，它跟代表实际屏幕物理像素的px不是一回事。</p> <p>第二、每个移动设备浏览器中都有一个理想的宽度，这个理想的宽度是指css中的宽度，跟设备的物理宽度没有关系，在css中，这个宽度就相当于100%的所代表的那个宽度。我们可以用meta标签把viewport的宽度设为那个理想的宽度，如果不知道这个设备的理想宽度是多少，那么用device-width这个特殊值就行了，同时initial-scale=1也有把viewport的宽度设为理想宽度的作用。所以，我们可以使用</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>来得到一个理想的viewport（也就是前面说的ideal viewport）。
为什么需要有理想的viewport呢？比如一个分辨率为320x480的手机理想viewport的宽度是320px，而另一个屏幕尺寸相同但分辨率为640x960的手机的理想viewport宽度也是为320px，那为什么分辨率大的这个手机的理想宽度要跟分辨率小的那个手机的理想宽度一样呢？这是因为，只有这样才能保证同样的网站在不同分辨率的设备上看起来都是一样或差不多的。实际上，现在市面上虽然有那么多不同种类不同品牌不同分辨率的手机，但它们的理想viewport宽度归纳起来无非也就 320、360、384、400等几种，都是非常接近的，理想宽度的相近也就意味着我们针对某个设备的理想viewport而做出的网站，在其他设备上的表现也不会相差非常多甚至是表现一样的。</p> <p>一句话解释：<code>width=device-width, initial-scale=1可以让网站css的width=100%为手机屏幕的宽度</code></p> <h1 id="移动端适配"><a href="#移动端适配" class="header-anchor">#</a> 移动端适配</h1> <p>问题的引出：由viewport的知识我们可以知道同样大小的屏幕由于devicePixelRatio的不同,css中1px在不同屏幕上的表现是不一样的。</p> <p>为了编写一套css就可以在移动端适配不同屏幕，最后选择使用淘宝的<code>lib-flexible弹性布局方案</code>，需要了解以下知识点。</p> <h2 id="ui设计过程"><a href="#ui设计过程" class="header-anchor">#</a> ui设计过程</h2> <p><img src="/images/ref/%E7%A7%BB%E5%8A%A8%E5%BC%80%E5%8F%919.png" alt="Alt text"></p> <ol><li>以iphone6 750 x 1344为设计稿</li> <li>在设计稿上按照实际大小进行px标注，并切出@2x图片（可以只切@3x）</li> <li>矢量放大1.5倍后，切出@3x图</li></ol> <h2 id="开发过程"><a href="#开发过程" class="header-anchor">#</a> 开发过程</h2> <p>图片加载：</p> <ol><li>在devicePixelRatio&lt;=2时，加载@2x切图</li> <li>在devicePixelRatio&gt;2时，加载@3x切图</li></ol> <p>如果只切@3x图,那么就全加载@3x</p> <p>元素尺寸计算：
设计稿标注100px, css中使用rem = 100 / 75(该设计稿对应的html的font-size),即标注150px，代码中使用2rem
设计稿对应的html的font-size计算<code>font-size = deviceWidth / 10</code>,所以750设计稿对应的字体大小为75</p> <h2 id="vue中简化rem的计算"><a href="#vue中简化rem的计算" class="header-anchor">#</a> vue中简化rem的计算</h2> <p>直接引用flexible.js,比较烦人的是每次都要手动计算rem,除以75还是很难算的。</p> <p>可以使用scss定义一个@mixin px2rem($px)来进行rem的计算,但是写css的时候老是要@include px2rem(..)也很不方便，如果能直接写px，在编译时webpack帮我转成rem就好了。</p> <p>使用px2rem-loader自动将css中的px转换成rem：</p> <ol><li>npm install px2rem-loader -s</li> <li>打开build/utils.js文件，找到exports.cssLoaders方法，在里面添加如下代码</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> px2remLoader <span class="token operator">=</span> <span class="token punctuation">{</span>
    loader<span class="token operator">:</span> <span class="token string">'px2rem-loader'</span><span class="token punctuation">,</span>
    options<span class="token operator">:</span> <span class="token punctuation">{</span>
      remUint<span class="token operator">:</span> <span class="token number">75</span>  <span class="token comment">//设计稿根字体的大小</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ol start="3"><li>修改generateLoaders方法中的loaders</li></ol> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> loaders <span class="token operator">=</span> <span class="token punctuation">[</span>cssLoader<span class="token punctuation">,</span> px2remLoader<span class="token punctuation">]</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>usePostCSS<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  loaders<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>postcssLoader<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>注意：</p> <ol><li>此方法只能将.vue的style标签、.css文件中的px转成rem，不能将script标签和内联样式里面定义的px转成rem</li> <li>如果在.vue文件style中的某一行代码不希望被转成rem，只要在后面写上注释 /* no*/就可以了</li></ol> <p>规则：</p> <ol><li>width、height等需要转换为rem</li> <li>border不需要转换,后面要加 /<em>no</em>/,原样输出</li> <li>font-size比较特殊，后面要加 /<em>px</em>/,会根据dpr不同生成3套css（都是禁止缩放的，设置成no也一样）
<img src="/images/ref/%E7%A7%BB%E5%8A%A8%E5%BC%80%E5%8F%9110.png" alt="Alt text"></li></ol> <h3 id="引入第三方库问题"><a href="#引入第三方库问题" class="header-anchor">#</a> 引入第三方库问题</h3> <p>使用了px2rem-loader后，第三方ui库的px也被转义成rem了，组件都变小了。</p> <p>这是因为第三方一般都是按照initial-scale=1来开发适配的，使用了lib-flexible后我们在dpr=2时 initial-scale=1= 0.5</p> <p>解决方法：remUint: 75 换成37.5, 这样第三方ui px全都扩大2倍, 代码中我们取设计图上px/2</p> <h2 id="为啥是750px的设计稿"><a href="#为啥是750px的设计稿" class="header-anchor">#</a> 为啥是750px的设计稿</h2> <p>750px是iphone6的屏幕在css中的像素(750*1344)。</p> <p>在iphone6出现之前，据说淘宝的设计师都是按iphone的尺寸出一套设计稿，安卓的设备也根据这套设计稿开发；iphone6出现之后，为了统一设计稿的标准，统一使用750的设计稿，iphone6 plus通过矢量放大的方式出@3x的设计稿，其它设备都按这两个稿开发。之所以用750，这是淘宝自己定的一个设计稿基准。</p> <h1 id="font-boosting"><a href="#font-boosting" class="header-anchor">#</a> Font Boosting</h1> <p>在移动端页面开发中，使用一个css来设置元素中的font-size，但是对于同一个class设置，在不同元素中效果却不同，而且在调试的时候该表font-size发现也有相应，说明这个class有效果，但是在不同元素中却得到不同的效果，特别当元素中含有的文本元素数量差别较大时。</p> <p>这个是一个叫font-boosting的问题，当文本数量太多，计算机认为在屏幕上显示这么多文本会导致用户不能清晰阅读时，他会自动设置font-size的大小，这个时候得到不同的字体大小的效果，</p> <p>解决方法：在该元素的class中添加max-height:100%，这个对于元素显示没有效果，但是可以防止font-boosting。</p> <h1 id="_1px-2"><a href="#_1px-2" class="header-anchor">#</a> 1px</h1> <p>vux 1px解决方案</p> <h1 id="iso-click延迟问题"><a href="#iso-click延迟问题" class="header-anchor">#</a> iso click延迟问题</h1> <div class="language-javaScript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//解决ios click问题</span>
<span class="token class-name">FastClick</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">focus</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">targetElement</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> length<span class="token punctuation">;</span>
 <span class="token comment">// Issue #160: on iOS 7, some input elements (e.g. date datetime month) throw a vague TypeError on setSelectionRange. These elements don't have an integer value for the selectionStart and selectionEnd properties, but unfortunately that can't be used for detection because accessing the properties also throws a TypeError. Just check the type instead. Filed as Apple bug #15122724.</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>deviceIsIOS <span class="token operator">&amp;&amp;</span> targetElement<span class="token punctuation">.</span>setSelectionRange <span class="token operator">&amp;&amp;</span> targetElement<span class="token punctuation">.</span>type<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'date'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> targetElement<span class="token punctuation">.</span>type <span class="token operator">!==</span> <span class="token string">'time'</span> <span class="token operator">&amp;&amp;</span> targetElement<span class="token punctuation">.</span>type <span class="token operator">!==</span> <span class="token string">'month'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    length <span class="token operator">=</span> targetElement<span class="token punctuation">.</span>value<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    targetElement<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    targetElement<span class="token punctuation">.</span><span class="token function">setSelectionRange</span><span class="token punctuation">(</span>length<span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    targetElement<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
 <span class="token punctuation">}</span><span class="token punctuation">;</span>

FastClick<span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>body<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h1 id="开启gzip压缩"><a href="#开启gzip压缩" class="header-anchor">#</a> 开启gzip压缩</h1> <p>webPack：使用compression-webpack-plugin</p> <p>nginx：
gzip  on;# 启用 gzip 压缩功能
gzip_http_version 1.1; # 默认值是1.1，就是说对HTTP/1.1协议的请求才会进行gzip压缩
gzip_vary on;
gzip_comp_level 6; # 压缩级别，1压缩比最小处理速度最快，9压缩比最大但处理最慢，同时也最消耗CPU,一般设置为3就可以了
gzip_proxied any;# nginx 做前端代理时启用该选项，表示无论后端服务器的headers头返回什么信息，都无条件启用压缩
gzip_min_length  1024;# 最小压缩的页面，如果页面过于小，可能会越压越大，这里规定大于1K的页面才启用压缩
gzip_buffers 16 8k;# 设置系统获取几个单位的缓存用于存储gzip的压缩结果数据流
gzip_disable &quot;MSIE [1-6].(?!.*SV1)&quot;;# 禁用IE6的gzip压缩</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/realpdai/tech-arch-doc/edit/master/md/待整理/Vue-移动开发踩坑.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2020-6-26 17:00:44</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.afcd353c.js" defer></script><script src="/assets/js/2.6527dd7c.js" defer></script><script src="/assets/js/67.aeba61a8.js" defer></script>
  </body>
</html>
